streamlit==1.28.0
pymupdf==1.23.5
pandas==2.1.4
openpyxl==3.1.2
numpy==1.25.0

import streamlit as st
import fitz  # pymupdf
import json
import pandas as pd
import re
import os
import tempfile
import numpy as np

def pdf_to_json(pdf_file, json_file_path):
    """Mengkonversi file PDF ke JSON menggunakan pymupdf"""
    text_data = []
    
    try:
        pdf_document = fitz.open(stream=pdf_file.getvalue(), filetype="pdf")
        
        for page_num in range(len(pdf_document)):
            page = pdf_document.load_page(page_num)
            text = page.get_text()
            if text:
                text_data.append(text)
        
        pdf_document.close()
        
        with open(json_file_path, 'w', encoding='utf-8') as output_file:  
            json.dump(text_data, output_file, ensure_ascii=False, indent=4)
        
        return text_data
    except Exception as e:
        st.error(f"Error reading PDF: {str(e)}")
        return []
